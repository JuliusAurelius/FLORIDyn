%% Post-Sim Visulization
%   Contour Plot of the wind field

% 

F = scatteredInterpolant(...
    op_pos_old(:,1),...
    op_pos_old(:,2),...
    sqrt(sum(op_u.^2,2)),'nearest','none');

u_grid_z_tmp = F(u_grid_x(:),u_grid_y(:));
nan_z = isnan(u_grid_z_tmp);
u_grid_z_tmp2 = getWindVec3(...
    [u_grid_x(nan_z),u_grid_y(nan_z)],...
    IR, U_abs(i,:), U_ang(i,:), uf_n, uf_lims);
u_grid_z_tmp(nan_z) = sqrt(sum(u_grid_z_tmp2.^2,2));
u_grid_z = reshape(u_grid_z_tmp,size(u_grid_z));

figure(2)
contourf(u_grid_x,u_grid_y,u_grid_z);
title('Filled contour plot')
axis equal
c = colorbar;
c.Label.String ='Windspeed [m/s]';
xlabel('West-East [m]')
ylabel('South-North [m]')